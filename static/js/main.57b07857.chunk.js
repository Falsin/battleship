(this.webpackJsonpbattle_ship=this.webpackJsonpbattle_ship||[]).push([[0],{44:function(e,n,t){},45:function(e,n,t){"use strict";t.r(n);var r,i,a,s=t(0),c=t.n(s),l=t(24),o=t.n(l),d=t(15),u=t(2),f=t(3),h=t(4),v=t(1),j=h.a.footer(r||(r=Object(f.a)(["\n  padding: 2vmin;\n  background: darkblue;\n\n  & a {\n    color: white;\n    text-decoration: none;\n  }\n"])));function b(){return Object(v.jsx)(j,{children:Object(v.jsx)("a",{href:"https://github.com/Falsin",children:"Made by Falsin"})})}var p=h.a.header(i||(i=Object(f.a)(["\n  background: red;\n  padding: 2vmin;\n  margin: 0;\n"]))),y=h.a.h1(a||(a=Object(f.a)(["\n  padding: 0;\n  margin: 0;\n  text-align: center;\n"])));function O(e){return Object(v.jsx)(p,{children:Object(v.jsx)(y,{children:"Battleship"})})}var m=t(6),g=t(8);var x=function e(n){var t;if(Array.isArray(n)){t=[];var r,i=Object(g.a)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.push(e(a))}}catch(l){i.e(l)}finally{i.f()}}else if("object"===typeof n&&n){var s=e(Object.getPrototypeOf(n));for(var c in t=Object.create(s),n)Object.hasOwnProperty.call(n,c)&&(t[c]=e(n[c]))}else t=n;return t},A=t(29),C=t(22);var k=function(e){var n=function(e){var n={isDamage:!1};return new Array(e.length).fill().map((function(){return Object.assign({},n)}))}(e);return{shipPart:n,hit:function(e){n[e].isDamage=!0},isSunk:function(){return n.filter((function(e){return e.isDamage})).length===n.length},isPlaced:!1}};var S=function(){return{placeShips:function(e){var n=this,t=this.newShipsArray.find((function(e){return!e.isPlaced}));if(this.hoveredCells.isValid&&this.hoveredCells.cellsArray.length){var r,i=t.shipPart.map((function(e,t){return e.coord=n.hoveredCells.cellsArray[t]}));(r=this.selectedCells).push.apply(r,Object(A.a)(i)),t.isPlaced=!0,this.hoveredCells.cellsArray=[]}else this.addCellsIntoHoveredCells(t,e)},newShipsArray:[{name:"carrier",length:5,destroyed:!1},{name:"battleship",length:4,destroyed:!1},{name:"Cruiser",length:3,destroyed:!1},{name:"submarine",length:3,destroyed:!1},{name:"destroyer",length:2,destroyed:!1}].map((function(e){return Object(C.a)(Object(C.a)({},e),k(e))})),addCellsIntoHoveredCells:function(e,n){if("horizontal"===this.orientation)if(n%10+e.length<=10){for(var t=!0,r=n;r<=n+e.length;r++)if(this.selectedCells.includes(r)){t=!1;break}t?(this.hoveredCells.cellsArray=e.shipPart.map((function(e,t){return n+t})),this.hoveredCells.isValid=!0):(this.hoveredCells.cellsArray=e.shipPart.map((function(e,t){return n+t})),this.hoveredCells.isValid=!1)}else{this.hoveredCells.cellsArray=[];for(var i=0;n%10+i<10;)this.hoveredCells.cellsArray.push(n+i++);this.hoveredCells.isValid=!1}else if("vertical"===this.orientation)if(n+(10*e.length-10)<=99){for(var a=!0,s=n;s<n+10*e.length;s+=10)if(this.selectedCells.includes(s)){a=!1;break}a?(this.hoveredCells.cellsArray=e.shipPart.map((function(e,t){return n+10*t})),this.hoveredCells.isValid=!0):(this.hoveredCells.cellsArray=e.shipPart.map((function(e,t){return n+10*t})),this.hoveredCells.isValid=!1)}else{this.hoveredCells.cellsArray=[];for(var c=0;n+c<=99;)this.hoveredCells.cellsArray.push(n+c),c+=10;this.hoveredCells.isValid=!1}},hoveredCells:{cellsArray:[],isValid:!0},selectedCells:[],changeOrientation:function(){return this.orientation="vertical"===this.orientation?"horizontal":"vertical"},orientation:"horizontal",attackedCells:[]}};function w(){var e=S();return Object.assign(Object.create(e),{isReady:!1,getDamage:function(e,n){var t=x(e.state);if(this.selectedCells.includes(e.index))for(var r=0;r<t.player.newShipsArray.length;r++){var i=t.player.newShipsArray[r].shipPart.find((function(n){return n.coord===e.index}));if(i){t.player.isActive=!1,i.isDamage=!0,e.state.func(t.player);break}}else t.player.isActive=!1,n(!1),e.state.func(t.player)},isGameOver:!1,isLose:!1})}var P,H,D=function(){var e=null;return function(){var n=w(),t=e;return Object.assign(Object.create(n),{name:t,isActive:!0,setName:function(n){t=n,this.name=t,e=n,this.name=n}})}}(),G=h.a.div(P||(P=Object(f.a)(["\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  & * {\n    padding: 0;\n    margin: 1vmin;\n  }\n\n  & input {\n    padding: 1vmin;\n    border: solid gray 1px;\n    outline: none;\n  }\n\n  a {\n    display: block;\n    border: solid gray 1px;\n    padding: 1vmin;\n    text-decoration: none;\n    color: black;\n  }\n"])));function E(e){return Object(v.jsxs)(G,{children:[Object(v.jsx)("h3",{children:"Enter player name:"}),Object(v.jsx)("input",{placeholder:"Combat",onBlur:function(e){D().setName(e.target.value)}}),Object(v.jsx)(d.b,{to:"/gamePage",children:"Start game"})]})}var R=h.a.div(H||(H=Object(f.a)(["\n  background: ",";\n  border: solid white 1px;\n"])),(function(e){return!1===e.isDamage.key?"green":e.error.key||e.isDamage.key?"red":e.status.key||e.hover.key?"gray":"rgb(66, 66, 255)"}));function V(e){var n=Object(s.useState)(!1),t=Object(m.a)(n,2),r=t[0],i=t[1],a=Object(s.useState)(!1),c=Object(m.a)(a,2),l=c[0],o=c[1],d=Object(s.useState)(!1),u=Object(m.a)(d,2),f=u[0],h=u[1],j=Object(s.useState)(null),b=Object(m.a)(j,2),p=b[0],y=b[1],O=e.state.player,A=O.newShipsArray;function C(){return null!==p||O.isGameOver?null:O.isReady&&O.isActive?O.getDamage(e,y):e.isHuman&&!O.isReady?function(){var n=x(O);n.placeShips(e.index),n.newShipsArray.find((function(e){return!e.isPlaced}))||(n.isReady=!0,n.isActive=!1),e.state.func(n)}():void 0}return Object(s.useEffect)((function(){if(O.isReady){if(O.selectedCells.includes(e.index)){i(!0);for(var n=0;n<O.newShipsArray.length;n++){var t=O.newShipsArray[n].shipPart.find((function(n){return n.coord===e.index}));if(t&&t.isDamage&&!p){y(!0);break}}}}else if(O.hoveredCells.cellsArray.includes(e.index))O.hoveredCells.isValid?(h(!0),o(!1)):o(!0);else{h(!1),o(!1);var r,a=Object(g.a)(A);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.isPlaced)s.shipPart.find((function(n){return n.coord===e.index}))&&i(!0)}}catch(c){a.e(c)}finally{a.f()}}})),Object(s.useEffect)((function(){e.coordOfAttack&&O.getDamage(e,y)}),[e.coordOfAttack]),Object(v.jsx)(R,{onClick:function(){return C()},onMouseEnter:function(){return O.isReady||!e.isHuman?null:function(){var n=x(O),t=n.newShipsArray.find((function(e){return!e.isPlaced}));n.addCellsIntoHoveredCells(t,e.index),e.state.func(n)}()},status:{key:r},error:{key:l},isDamage:{key:p},hover:{key:f},children:e.index})}function z(e,n){var t=e.state.player,r=n.state.player;if(n.coordOfAttack)return!1;if(t.hoveredCells.cellsArray.includes(n.index)||r.hoveredCells.cellsArray.includes(n.index))return!1;if(t.isReady!==r.isReady||t.isActive!==r.isActive)return!1;if(t.orientation!==r.orientation)return!1;if(B(t.selectedCells)!==B(r.selectedCells))return!1;var i,a=t.newShipsArray,s=Object(g.a)(a);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(c.isPlaced)if(c.shipPart.find((function(e){return e.coord===n.index})))return!1}}catch(l){s.e(l)}finally{s.f()}return!0}function B(e){return e.reduce((function(e,n){return e+n}),0)}var I,M=c.a.memo(V,z),N=t(13),F=h.a.div(I||(I=Object(f.a)(["\n  display: flex;\n  align-items: center;\n\n  div {\n    display: grid;\n    grid-template-columns: repeat(10, 4vmin);\n    grid-template-rows: repeat(10, 4vmin); \n  }\n\n  button {\n    margin-right: 2vmin;\n  }\n"])));function J(e){var n,t=Object(N.useState)(null),r=Object(m.a)(t,2),i=r[0],a=r[1],s={player:e.player,func:e.func};return Object(N.useEffect)((function(){if("robot"===e.player.name)for(var n=x(e.player),t=n.newShipsArray.find((function(e){return!e.isPlaced}));void 0!==t;)n.orientation=["vertical","horizontal"][L(1,2)],n.addCellsIntoHoveredCells(t,L(1,100)),n.placeShips(),n.isReady=!0,t=n.newShipsArray.find((function(e){return!e.isPlaced})),e.func(n)}),[]),Object(N.useEffect)((function(){if(e.isHuman&&e.player.isActive&&e.player.isReady){var n=x(e.player),t=L(1,100);if(n.attackedCells.includes(t))for(;!0===n.attackedCells.includes(t);)t=L(1,100);a(t),n.attackedCells.push(t),e.func(n)}}),[e.player.isActive]),Object(N.useEffect)((function(){var n,t=x(e.player),r=Object(g.a)(t.newShipsArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.shipPart.filter((function(e){return!0===e.isDamage})).length===i.length&&(i.destroyed=!0)}}catch(c){r.e(c)}finally{r.f()}var a=t.newShipsArray.find((function(e){return!1===e.destroyed})),s=Object.getPrototypeOf(t);a||s.isGameOver||(s.isGameOver=!0,t.isLose=!0,e.func(t))})),Object(v.jsxs)(F,{children:[e.isHuman?Object(v.jsxs)("button",{onClick:function(){var n=x(e.player);n.changeOrientation(),e.func(n)},children:["axis: ","horizontal"===e.player.orientation?"X":"Y"]}):null,Object(v.jsx)("div",{children:(n=100,new Array(n).fill().map((function(n,t){return t===i?Object(v.jsx)(M,{index:t,state:s,isHuman:e.isHuman,coordOfAttack:!0},t):Object(v.jsx)(M,{index:t,state:s,isHuman:e.isHuman,coordOfAttack:!1},t)})))})]})}function L(e,n){return Math.round(e+(n-e+1)*Math.random()-.5)-1}var _,X=t.p+"static/media/refreshArrow.edb31e23.svg",Y=t(14),q=t.n(Y),K=h.a.div(_||(_=Object(f.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background: rgba(135, 99, 99, 0.5);\n  font-weight: 900;\n  color: white;\n\n  h1 {\n    text-shadow: 0 0 6px black;\n  }\n"])));var Q,T,U=function(e){return Object(v.jsxs)(K,{children:[Object(v.jsx)("h1",{children:"Game over!"}),Object(v.jsx)("div",{children:e.loserName+" lost!"}),Object(v.jsx)("img",{src:X,onClick:function(){return e.func(q()())}})]})},W=h.a.div(Q||(Q=Object(f.a)(["\n  #gameBoards {\n    display: flex;\n    justify-content: space-evenly;\n    position: relative;\n  }\n"])));function Z(e){var n=Object(s.useState)(D()),t=Object(m.a)(n,2),r=t[0],i=t[1],a=Object(s.useState)(function(){var e=w();return Object.assign(Object.create(e),{name:"robot",isActive:!1})}()),c=Object(m.a)(a,2),l=c[0],o=c[1],d=Object(s.useState)(null),u=Object(m.a)(d,2),f=u[0],h=u[1];return $(l,[r,i]),$(r,[l,o]),Object(s.useEffect)((function(){if(l.isGameOver){var e=x(l);o(e),h(e.name)}else if(r.isGameOver){var n=x(r);o(n),h(n.name)}}),[l.isGameOver,r.isGameOver]),Object(v.jsx)(W,{children:Object(v.jsxs)("div",{id:"gameBoards",children:[Object(v.jsx)(J,{player:r,func:i,isHuman:!0}),Object(v.jsx)(J,{player:l,func:o}),r.isGameOver||l.isGameOver?Object(v.jsx)(U,{func:e.func,loserName:f}):null]})})}function $(e,n){Object(s.useEffect)((function(){if(!e.isActive){var t=x(n[0]);t.isActive=!0,n[1](t)}}),[e.isActive])}function ee(e){var n=Object(s.useState)(q()()),t=Object(m.a)(n,2),r=t[0],i=t[1];return"registration"===e.page?Object(v.jsx)(E,{}):Object(v.jsx)(Z,{func:i},r)}var ne=h.a.section(T||(T=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n"])));function te(e){return Object(v.jsxs)(ne,{children:[Object(v.jsx)(O,{}),Object(v.jsx)(ee,{page:"registration"}),Object(v.jsx)(b,{})]})}var re=function(e){return Object(v.jsxs)("section",{children:[Object(v.jsx)(O,{}),Object(v.jsx)(ee,{}),Object(v.jsx)(b,{})]})};var ie=function(){return Object(v.jsx)(d.a,{children:Object(v.jsxs)(u.c,{children:[Object(v.jsx)(u.a,{exact:!0,path:"/",component:te}),Object(v.jsx)(u.a,{exact:!0,path:"/gamePage",component:re})]})})};t(44);o.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(ie,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.57b07857.chunk.js.map